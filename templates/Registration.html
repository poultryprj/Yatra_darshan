{% load i18n %}
{% load static %}
{% load pwa %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Yatra Darshan - Registration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
    <link rel="manifest" href="{% static 'assets/__manifest.json' %}">

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f9f9f9;
            margin: 0;
            padding: 0;
        }

        /* Navbar / Toolbar */
        .navbar {
            background-color: #e66a00;
            height: 55px;
        }
        .navbar-toggler {
            border: none;
            background-color: white;
            border-radius: 4px;
            padding: 4px 8px;
        }
        .navbar-toggler-icon {
            display: inline-block;
            width: 20px;
            height: 2px;
            background-color: black;
            position: relative;
        }
        .navbar-toggler-icon::before,
        .navbar-toggler-icon::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 2px;
            background-color: black;
            left: 0;
        }
        .navbar-toggler-icon::before { top: -6px; }
        .navbar-toggler-icon::after { top: 6px; }
        .navbar-brand {
            color: white;
            font-size: 18px;
            margin-left: 8px;
        }

        /* Drawer / Side Menu */
        .drawer {
            position: fixed;
            top: 55px;
            left: -100%;
            width: 70%;
            height: calc(100% - 55px);
            background-color: #f8f9fa;
            transition: left 0.3s ease;
            padding: 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
        }
        .drawer.open { left: 0; }
        .drawer ul { padding: 10px 20px; font-size: 15px; }
        .drawer ul li { list-style: none; margin-bottom: 8px; }
        .drawer ul li a {
            text-decoration: none;
            color: #333;
            font-size: 17px;
        }
        .drawer ul li a i {
            margin-right: 15px;
            font-size: 20px;
        }
        .additional-content {
            position: sticky;
            top: 0;
            background-color: rgb(238, 238, 240);
            color: white;
            padding: 10px 0;
            z-index: 1001;
            width: 100%;
            text-align: center;
        }
        .additional-content img.logo {
            display: block;
            margin: 0 auto 10px auto; /* add some bottom margin to separate text */
            height: 100px;
            width: 100px;
            border-radius: 50%;       /* circular */
            object-fit: cover;        /* scale image properly */
        }

        .drawer-close-btn {
            background: none;
            border: none;
            font-size: 20px;
            position: absolute;
            top: 5px;
            right: 10px;
            color: black;
        }

        /* Registration container */
        .container-reg {
            max-width: 600px;
            margin: 80px auto 40px auto;
            background: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
        }
        .container-reg h2 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 24px;
            color: #003399;
        }
        .form-group { margin-bottom: 18px; }
        label {
            font-weight: bold;
            display: block;
            margin-bottom: 6px;
            color: #003399;
        }
        input, select {
            width: 100%;
            padding: 12px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 6px;
            outline: none;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input:focus, select:focus {
            border-color: #006633;
            box-shadow: 0 0 5px rgba(0,102,51,0.4);
        }
        .btn-submit {
            width: 100%;
            padding: 14px;
            font-size: 16px;
            font-weight: bold;
            background: #ff7b00;  /* changed from gradient to orange */
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn-submit:hover {
            transform: scale(1.03);
            background: #e67000;  /* slightly darker on hover */
        }

        /* Search bar */
        .search-bar {
            display: flex;
            margin-bottom: 20px;
        }
        .search-bar input {
            flex: 1;
            padding: 12px;
            font-size: 14px;
            border: 2px solid #006633;
            border-radius: 6px 0 0 6px;
            outline: none;
        }
        .search-bar button {
            padding: 12px 18px;
            font-size: 14px;
            cursor: pointer;
            background: #ff7b00;  /* changed to orange */
            color: #fff;
            border: none;
            border-radius: 0 6px 6px 0;
            transition: 0.3s;
        }

        .search-bar button:hover { 
            background: #e67000;  /* hover effect */
        }

        /* Route Yatra container buttons */
        .route-select-btn {
            padding: 10px 15px;
            border-radius: 6px;
            border: 1px solid #28a745;
            background: white;
            color: #28a745;
            cursor: pointer;
        }

        .route-select-btn.active {
            background: #28a745;
            color: white;
        }

        .section-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: #003399;
        }
        .card {
            background: #fff;
            border-radius: 10px;
            padding: 5px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .listview .item {
            display: flex;
            align-items: center;
            padding: 10px;
            text-decoration: none;
            color: #000;
        }
        .icon-box {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            margin-right: 12px;
        }
        .bg-success { background-color: #28a745 !important; }
        .in { flex: 1; display: flex; justify-content: space-between; align-items: center; }
        .text-small { font-size: 13px; color: #666; }

        /* Yatra Route Cards */
        .route-card { background: #fff; border-radius: 10px; margin-bottom: 15px; padding: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .route-card-title { font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #003399; }
        .yatra-list { list-style: none; padding: 0; margin: 0; }
        .yatra-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #eee; }
        .yatra-info { display: flex; flex-direction: column; }
        .yatra-date { font-weight: bold; font-size: 14px; color: #006633; }
        .yatra-fees { font-weight: bold; font-size: 14px; color: #e67000; margin-bottom: 4px; }
        .yatra-toggle { display: flex; align-items: center; }
        .yatra-toggle input[type="checkbox"] { width: 36px; height: 20px; }

        .toggle-wrapper {
            position: relative;
            width: 50px;
            height: 28px;
        }

        .toggle-wrapper input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0;
            right: 0; bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 14px; /* rounded pill */
        }

        .slider::before {
            position: absolute;
            content: "";
            height: 22px; width: 22px;
            left: 3px; bottom: 3px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #28a745; /* active color */
        }

        input:checked + .slider::before {
            transform: translateX(22px); /* slide circle */
        }

        /* Remove bullets from route list */
        .route-card ul {
            list-style: none; /* removes the dots */
            padding-left: 0;  /* remove default indentation */
            margin: 0;        /* optional: remove extra space */
        }

    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid d-flex align-items-center justify-content-center position-relative">
        <button class="navbar-toggler" type="button" id="menuBtn" style="position: absolute; left: 15px;">
            <span class="navbar-toggler-icon"></span>
        </button>
        <span class="navbar-brand mb-0" style="font-size: 18px;">Welcome - {{ user.first_name }} {{ user.last_name }}</span>
    </div>
</nav>

<!-- Side Drawer -->
<div id="drawer" class="drawer">
    <div class="additional-content">
        <img src="{% static 'assets/img/lakshya_pratishthan.png' %}" alt="Logo" class="logo" style="margin-bottom:0;" />
        <p style="font-size: 25px;color: black ;margin-top:0;"><b>Darshan Yatra</b></p>
        <button class="drawer-close-btn" onclick="closeDrawer()">&times;</button>
    </div>
    <ul>
        <li><a href="{% url 'Registrationpage' %}"><i class="bi bi-house-door"></i> Home</a></li>

        <li><a href="{% url 'dashboard' %}"><i class="bi bi-grid-1x2-fill"></i> Dashboard</a></li>

        <li><a href="{% url 'user_master' %}"><i class="bi bi-people-fill"></i> User Management</a></li>

        <li><a href="{% url 'route_master' %}"><i class="bi bi-geo-alt-fill"></i> Route Master</a></li>

        <li><a href="{% url 'area_master' %}"><i class="bi bi-map-fill"></i> Area Master</a></li>

        <li><a href="{% url 'yatra_master' %}"><i class="bi bi-calendar-event-fill"></i> Yatra Master</a></li>

        <li><a href="{% url 'daily_report' %}"><i class="bi bi-cash-coin"></i> Daily Collection</a></li>

        <li><a href="{% url 'print_report_page' %}"><i class="bi bi-printer-fill"></i> Print Report</a></li>
 
        <li><a href="{% url 'logout' %}"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
    </ul>
</div>

<!-- Registration Form -->
<div class="container-reg">

    <h2>User Registration</h2>

    <!-- Search Bar -->
    <div class="search-bar">
        <input type="text" id="searchMobile" placeholder="Enter Mobile Number">
        <button type="button" onclick="searchUser()">Search</button>
    </div>

    <div id="statusMsg" class="alert d-none" role="alert"></div>

    <!-- Registration Form Fields -->

        <!-- Registration ID -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="registration_id">Registration ID</label>
                <input type="text" id="registration_id" class="form-control" value="0" readonly>
            </div>
        </div>

        <!-- First Name -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="first_name">First Name</label>
                <input type="text" id="first_name" class="form-control" placeholder="Enter First Name">
            </div>
        </div>

        <!-- Last Name -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="last_name">Last Name</label>
                <input type="text" id="last_name" class="form-control" placeholder="Enter Last Name">
            </div>
        </div>

        <!-- Aadhar No -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="aadhar_no">Aadhar No.</label>
                <input type="text" id="aadhar_no" class="form-control" placeholder="Enter Aadhar No">
            </div>
        </div>

        <!-- Date of Birth -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="dob">Date of Birth</label>
                <input type="date" id="dob" class="form-control">
            </div>
        </div>

        <!-- Mobile No -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="mobile_no">Mobile No.</label>
                <input type="text" id="mobile_no" class="form-control" placeholder="Enter Mobile No">
            </div>
        </div>

        <!-- Alternate Mobile No -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="alt_mobile_no">Alternate Mobile No.</label>
                <input type="text" id="alt_mobile_no" class="form-control" placeholder="Enter Alternate Mobile No">
            </div>
        </div>

        <!-- Address -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="address">Address</label>
                <input type="text" id="address" class="form-control" placeholder="Enter Address">
            </div>
        </div>

        <!-- Area -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="area">Area</label>
                <select id="area" class="form-control">
                    <option value="" selected disabled>Select Area</option>
                </select>
            </div>
        </div>

        <!-- Blood Group -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="blood_group">Blood Group</label>
                <select id="blood_group" class="form-control">
                    <option value="" selected disabled>Select Blood Group</option>
                </select>
            </div>
        </div>

        <!-- Gender -->
        <div class="form-group basic animated">
            <div class="form-group">
                <label for="gender">Gender</label>
                <select id="gender" class="form-control">
                    <option value="" selected disabled>Select Gender</option>
                </select>
            </div>
        </div>

        <button type="button" class="btn-submit" onclick="submitForm()">Submit</button>

        <!-- Main button -->
        <div style="margin-top:15px;">
            <button type="button" id="routeYatraBtn" class="btn-submit" style="background:#555;">
                Select Route Yatra Date
            </button>
        </div>

        <div id="routeSelectionContainer" style="display:none; margin-top:20px;">
        <!-- Routes will be injected here -->
        </div>

        <!-- Payment & Booking Section -->
        <div id="paymentSection" style="display:none; margin-top:20px;">
        <div class="row align-items-end">
            
            <!-- Amount Payable -->
            <div class="col-md-6 col-12">
                <div class="form-group">
                    <label for="amountPayable">Amount Payable</label>
                    <input type="text" id="amountPayable" class="form-control" value="0" readonly>
                </div>
                </div>

                <!-- Amount Mode -->
                <div class="col-md-6 col-12">
                <div class="form-group">
                    <label class="form-label d-block mb-2">Amount Mode</label>
                    <div class="btn-group w-100" role="group" aria-label="Amount Mode">
                    <!-- Cash -->
                    <input type="radio" class="btn-check" name="amountMode" id="amountCash" value="cash" autocomplete="off">
                    <label class="btn btn-outline-success" for="amountCash">Cash</label>

                    <!-- UPI -->
                    <input type="radio" class="btn-check" name="amountMode" id="amountUPI" value="upi" autocomplete="off">
                    <label class="btn btn-outline-success" for="amountUPI">UPI</label>
                    </div>
                </div>
                </div>

            </div>

            <!-- Transaction ID (only for UPI) -->
            <div class="form-group" id="transactionIdField" style="display:none;">
                <label for="transactionId">Transaction ID</label>
                <input type="text" id="transactionId" class="form-control" placeholder="Enter UPI Transaction ID">
            </div>

            <!-- Book Ticket -->
            <button type="button" id="bookTicketBtn" class="btn-submit">Book Ticket</button>
            </div>
        </div>
            </form>
        </div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script>
    // Drawer logic
    const menuBtn = document.getElementById("menuBtn");
    const drawer = document.getElementById("drawer");
    menuBtn.addEventListener("click", () => { drawer.classList.add("open"); });
    function closeDrawer() { drawer.classList.remove("open"); }
    window.addEventListener("click", function (event) {
        if (!drawer.contains(event.target) && !menuBtn.contains(event.target)) closeDrawer();
    });

    // -------- Dropdown loader --------
    function callRegistrationAPI(action, extraData = {}) {
        const formData = new FormData();
        formData.append("action", action);
        for (const key in extraData) formData.append(key, extraData[key]);
        return fetch("/Yatra_darshan/registration_api/", { method: "POST", body: formData }).then(res => res.json());
    }

    function loadDropdown(action, selectId, valueField, textField) {
        const formData = new FormData();
        formData.append("action", action);

        fetch("{% url 'registration_api' %}", { method: "POST", body: formData })
            .then(res => res.json())
            .then(data => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Select</option>';
                if (data.message_code === 1000 && Array.isArray(data.message_data)) {
                    data.message_data.forEach(item => {
                        const option = document.createElement("option");
                        option.value = item[valueField];
                        option.textContent = item[textField];
                        select.appendChild(option);
                    });
                } else {
                    console.error("Failed to load dropdown:", selectId, data.message_text);
                }
            })
            .catch(err => console.error("Error fetching dropdown:", err));
    }

    // Load all dropdowns
    loadDropdown("list_area", "area", "AreaId", "AreaName");
    loadDropdown("list_bloodgroup", "blood_group", "BloodGroupId", "BloodGroupName");
    loadDropdown("list_gender", "gender", "GenderId", "GenderName");

    function clearForm() { document.getElementById("registrationForm").reset(); }

    function showMessage(type, text) {
        let box = document.getElementById("statusMsg");
        box.className = "alert"; // reset
        if (type === "success") {
            box.classList.add("alert-success");
        } else {
            box.classList.add("alert-danger");
        }
        box.textContent = text;
        box.classList.remove("d-none");
    }

    function searchUser() {
        let mobile = document.getElementById("searchMobile").value.trim();

        // Clear all fields immediately on input
        document.querySelectorAll(
            "#registration_id, #first_name, #last_name, #aadhar_no, #dob, #mobile_no, #alt_mobile_no, #address"
        ).forEach(el => el.value = "");
        document.getElementById("area").value = "";
        document.getElementById("blood_group").value = "";
        document.getElementById("gender").value = "";

        if (!mobile) { 
            showMessage("error", "Please enter a mobile number"); 
            return; 
        }

        const formData = new FormData();
        formData.append("action", "search");
        formData.append("search", mobile);

        fetch("{% url 'registration_api' %}", { method: "POST", body: formData })
            .then(res => res.json())
            .then(data => {
                if (data.message_code === 1000 && data.message_data) {
                    const u = data.message_data;

                    // Fill inputs with latest record
                    document.getElementById("registration_id").value = u.RegistrationId || "";
                    document.getElementById("first_name").value = u.Firstname || "";
                    document.getElementById("last_name").value = u.Lastname || "";
                    document.getElementById("aadhar_no").value = u.AadharNumber || "";
                    document.getElementById("dob").value = u.DateOfBirth || "";
                    document.getElementById("mobile_no").value = u.MobileNo || "";
                    document.getElementById("alt_mobile_no").value = u.AlternateMobileNo || "";
                    document.getElementById("address").value = u.Address || "";

                    // Auto-select dropdowns
                    setTimeout(() => {
                        document.getElementById("area").value = u.AreaId || "";
                        document.getElementById("blood_group").value = u.BloodGroup || "";
                        document.getElementById("gender").value = u.Gender || "";
                    }, 300);

                    // ✅ Show success message
                    showMessage("success", "Registration details fetched successfully.");

                } else {
                    // ❌ User not found
                    showMessage("error", data.message_text || "User not registered.");
                }
            })
            .catch(err => {
                console.error("Search error:", err);
                showMessage("error", "Something went wrong. Please try again.");
            });
    }

    function submitForm(event) {
        if (event) event.preventDefault();

        const formData = new FormData();
        formData.append("action", "submit");  // important

        formData.append("RegistrationId", document.getElementById("registration_id").value.trim() || "0");
        formData.append("userMobileNo", document.getElementById("mobile_no").value.trim());  // ✅ fixed key
        formData.append("userFirstname", document.getElementById("first_name").value.trim());
        formData.append("userMiddlename", document.getElementById("middle_name")?.value.trim() || "");
        formData.append("userLastname", document.getElementById("last_name").value.trim());
        formData.append("AreaId", document.getElementById("area")?.value || "1");   // default
        formData.append("Gender", document.getElementById("gender")?.value || "1"); // default
        formData.append("Address", document.getElementById("address").value.trim());
        formData.append("userAlternateMobileNo", document.getElementById("alt_mobile_no")?.value.trim() || "");
        formData.append("BloodGroup", document.getElementById("blood_group")?.options[document.getElementById("blood_group").selectedIndex]?.text || "Select"); // ✅ send text like "O+"
        
        // Convert DOB to DD/MM/YYYY
        const dobInput = document.getElementById("dob").value;
        if (dobInput) {
            const [yyyy, mm, dd] = dobInput.split("-");
            formData.append("DateOfBirth", `${dd}/${mm}/${yyyy}`);
        } else {
            formData.append("DateOfBirth", "");
        }

        formData.append("Photo", "");
        formData.append("PhotoId", "");
        formData.append("UserId", "1");

        console.log("➡️ Final Payload:", Object.fromEntries(formData));

        fetch("/Yatra_darshan/registration_api/", {
            method: "POST",
            body: formData
        })
        .then(res => res.json())
        .then(data => {
            console.log("✅ Response:", data);
            alert(data.message_text);
        })
        .catch(err => {
            console.error("❌ Error:", err);
        });
    }

    document.addEventListener("DOMContentLoaded", function() {
        Promise.all([
            loadDropdown("list_area", "area", "AreaId", "AreaName"),
            loadDropdown("list_bloodgroup", "blood_group", "BloodGroupId", "BloodGroupName"),
            loadDropdown("list_gender", "gender", "GenderId", "GenderName")
        ]).then(() => {
            console.log("All dropdowns loaded");
        });
    });

    document.getElementById("searchMobile").addEventListener("input", () => {
        // Clear fields instantly when user types a new number
        document.querySelectorAll(
            "#registration_id, #first_name, #last_name, #aadhar_no, #dob, #mobile_no, #alt_mobile_no, #address"
        ).forEach(el => el.value = "");
        document.getElementById("area").value = "";
        document.getElementById("blood_group").value = "";
        document.getElementById("gender").value = "";
        document.getElementById("statusMsg").classList.add("d-none"); // hide any previous messages
    });


</script>

<!-- Pass route data safely to JS -->
{{ route_yatras|json_script:"routeData" }}

<script>
document.addEventListener("DOMContentLoaded", function() {
    const routeData = JSON.parse(document.getElementById("routeData").textContent);
    const toggleBtn = document.getElementById("routeYatraBtn");
    const container = document.getElementById("routeSelectionContainer");

    toggleBtn.addEventListener("click", () => {
        if (container.style.display === "none") {
            renderGroupedRoutes();
        } else {
            container.style.display = "none";
            container.innerHTML = "";
        }
    });

    function renderGroupedRoutes() {
        container.innerHTML = "";

        routeData.forEach(route => {
            const card = document.createElement("div");
            card.classList.add("route-card");

            const title = document.createElement("div");
            title.classList.add("route-card-title");
            title.textContent = route.YatraRouteName;
            card.appendChild(title);

            const ul = document.createElement("ul");
            ul.classList.add("listview", "image-listview", "text", "inset", "no-line"); // Finapp style

            route.Yatras.forEach((yatra, index) => {
                const li = document.createElement("li");

                li.innerHTML = `
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <span class="yatra-date">Date: ${yatra.YatraDateTime}</span> |
                        <span class="yatra-fees">Fees: ₹${yatra.YatraFees}</span>
                    </div>
                    <label class="toggle-wrapper">
                        <input type="checkbox" 
                            id="SwitchCheck_${route.YatraRouteId}_${index}" 
                            data-route="${route.YatraRouteId}" 
                            data-yatra="${yatra.YatraId}" 
                            data-fees="${yatra.YatraFees}">
                        <span class="slider"></span>
                     </label>
                </div>
            `;

                ul.appendChild(li);
            });

            card.appendChild(ul);
            container.appendChild(card);
        });

        container.style.display = "block";
    }

});

document.addEventListener("DOMContentLoaded", function () {
    const container = document.getElementById("routeSelectionContainer");
    const paymentSection = document.getElementById("paymentSection");
    const amountPayableInput = document.getElementById("amountPayable");
    const transactionIdField = document.getElementById("transactionIdField");

    function calculateTotal() {
        let total = 0;
        container.querySelectorAll("input[type='checkbox']:checked").forEach(cb => {
            total += parseFloat(cb.dataset.fees) || 0;
        });
        amountPayableInput.value = total.toFixed(2);
    }

    // Recalculate when checkboxes change
    container.addEventListener("change", function (e) {
        if (e.target.type === "checkbox") {
            calculateTotal();
        }
    });

    // Toggle payment section with route list
    document.getElementById("routeYatraBtn").addEventListener("click", () => {
        if (container.style.display === "block") {
            paymentSection.style.display = "block";
        } else {
            paymentSection.style.display = "none";
        }
    });

    // Show/hide transaction ID field for UPI
    document.querySelectorAll("input[name='amountMode']").forEach(radio => {
        radio.addEventListener("change", function () {
            transactionIdField.style.display = (this.value === "upi") ? "block" : "none";
        });
    });

    // Book Ticket click
    document.getElementById("bookTicketBtn").addEventListener("click", function () {
        const mode = document.querySelector("input[name='amountMode']:checked")?.value;
        if (!mode) {
            alert("Please select Amount Mode");
            return;
        }
        if (mode === "upi" && !document.getElementById("transactionId").value.trim()) {
            alert("Please enter Transaction ID");
            return;
        }
        alert("✅ Ticket booked successfully!");
        // TODO: add fetch() to send selected Yatras + payment to backend
    });
});

</script>

</body>
</html>
